<?php /** Vista: disponibilidad de árbitros (administrador) */ ?>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Disponibilidad de Árbitros</title>
    <link rel="stylesheet" href="css/estilos.css" />
    <script defer src="js/app.js"></script>
</head>
<body>
<div class="layout-principal">
    <?php require __DIR__ . '/menu_admin.html'; ?>
  <main class="area-contenido">
    <h1>Disponibilidad de Árbitros</h1>
    <?php if (!empty($flash)): ?>
        <div class="alerta <?php echo $flash['exito'] ? 'exito' : 'error'; ?>"><?php echo htmlspecialchars($flash['mensaje']); ?></div>
    <?php endif; ?>
    <section class="seccion">
        <h2>Consultar por fecha</h2>
        <form method="POST" action="index.php?ruta=disponibilidad_arbitros&accion=consultar" class="formulario-inline">
            <input type="date" name="fecha" value="<?php echo htmlspecialchars($fecha ?? ''); ?>" required />
            <button class="boton-primario" type="submit">Consultar</button>
        </form>
    </section>
    <section class="seccion">
        <h2>Resultados <?php if(!empty($fecha)) echo '— ' . htmlspecialchars($fecha); ?></h2>
        <table class="tabla">
            <thead>
                <tr>
                    <th>Árbitro</th>
                    <th>Ciudad</th>
                    <th>Licencia</th>
                    <th>Mañana</th>
                    <th>Tarde</th>
                    <th>Obs. Mañana</th>
                    <th>Obs. Tarde</th>
                </tr>
            </thead>
            <tbody>
            <?php if (!empty($resultados)): ?>
                <?php foreach ($resultados as $r): ?>
                    <tr>
                        <td><?php echo htmlspecialchars(($r['apellidos'] ?? '') . ', ' . ($r['nombre'] ?? '')); ?></td>
                        <td><?php echo htmlspecialchars($r['ciudad'] ?? ''); ?></td>
                        <td><?php echo htmlspecialchars($r['licencia'] ?? ''); ?></td>
                        <td><?php echo ((int)$r['manana'] === 1) ? 'Disponible' : 'No'; ?></td>
                        <td><?php echo ((int)$r['tarde'] === 1) ? 'Disponible' : 'No'; ?></td>
                        <td><?php echo htmlspecialchars($r['observacion_manana'] ?? ''); ?></td>
                        <td><?php echo htmlspecialchars($r['observacion_tarde'] ?? ''); ?></td>
                    </tr>
                <?php endforeach; ?>
            <?php else: ?>
                <tr><td colspan="7" class="centrado">No hay registros para la fecha seleccionada.</td></tr>
            <?php endif; ?>
            </tbody>
        </table>
    </section>
  </main>
</div>
</body>
</html>